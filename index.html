<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kiberbiztonsági Műszerfal - Projekt Integráció</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

    <style>
        :root {
            --bg-color: #f0f2f5;
            --card-bg: #ffffff;
            --text-main: #1a1a1a;
            --text-light: #65676b;
            --accent: #1877f2;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 20px;
        }

        .header {
            max-width: 1000px;
            margin: 0 auto 30px;
            text-align: center;
            background: var(--card-bg);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .header h1 { margin: 0 0 10px; color: var(--accent); }
        .header p { color: var(--text-light); max-width: 700px; margin: 0 auto; }

        .dashboard-grid {
            max-width: 1000px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        @media (min-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr 1fr;
            }
            .full-width {
                grid-column: span 2;
            }
        }

        .card {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .card h3 { margin-top: 0; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        .card p.desc { font-size: 0.9em; color: var(--text-light); margin-bottom: 15px; }
        
        .vis-container { width: 100%; }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            color: var(--text-light);
            font-size: 0.8em;
        }
    </style>
</head>
<body>

    <header class="header">
        <h1>Vállalati Biztonsági Elemzés 2024</h1>
        <p>
            Ez a műszerfal <strong>1000 szimulált biztonsági incidenst</strong> elemez. 
            A cél: azonosítani, melyik osztály a leggyengébb láncszem.
            <br><em>(10. hét: Integrált Adatvizualizáció)</em>
        </p>
    </header>

    <main class="dashboard-grid">
        
        <section class="card full-width">
            <h3>1. Kockázat Osztályok Szerint (Vezérlő)</h3>
            <p class="desc">
                <strong>INTERAKTÍV:</strong> Kattints valamelyik oszlopra (pl. "Finance"), hogy az egész oldalt leszűrd arra az osztályra! 
                Látható, hogy bár az IT kezeli a legtöbb esetet, a Pénzügyön magas a kritikus hibák aránya.
            </p>
            <div id="vis_dept" class="vis-container"></div>
        </section>

        <section class="card">
            <h3>2. Incidensek Időbeli Eloszlása</h3>
            <p class="desc">Mikor történnek a támadások? Ha fent kiválasztasz egy osztályt, itt látod az ő specifikus trendjüket.</p>
            <div id="vis_trend" class="vis-container"></div>
        </section>

        <section class="card">
            <h3>3. Támadási Típusok Aránya</h3>
            <p class="desc">Milyen jellegű támadások érik a kiválasztott osztályt? (Phishing, Malware, stb.)</p>
            <div id="vis_type" class="vis-container"></div>
        </section>

    </main>

    <footer class="footer">
        Készítette: Arthur Vasinc | Business Intelligence Projekt | Generált adatpontok: 1000 db
    </footer>

    <script type="text/javascript">
        function generateData(count) {
            const data = [];
            const departments = ['IT', 'HR', 'Finance', 'Marketing', 'Sales'];
            const types = ['Phishing', 'Malware', 'Ransomware', 'DDoS', 'Social Eng.'];
            const severities = ['Low', 'Medium', 'High', 'Critical'];
            
            const start = new Date(2023, 0, 1);
            const end = new Date(2023, 11, 31);
            
            for (let i = 0; i < count; i++) {
                const date = new Date(start.getTime() + Math.random() * (end.getTime() - start.getTime()));
                
                const dept = departments[Math.floor(Math.random() * departments.length)];
                let type = types[Math.floor(Math.random() * types.length)];
                
                if(dept === 'Finance' && Math.random() > 0.6) {
                    type = 'Ransomware';
                }

                data.push({
                    "id": i,
                    "date": date.toISOString().split('T')[0],
                    "department": dept,
                    "type": type,
                    "severity": severities[Math.floor(Math.random() * severities.length)],
                    "cost": Math.floor(Math.random() * 5000) + 100
                });
            }
            return data;
        }

        const rawData = generateData(1000);
        console.log("Generált adatok (első 5 sor):", rawData.slice(0, 5));

        
        const commonData = { "values": rawData };

        const specDept = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": "container", "height": 200,
            "data": commonData,
            "selection": {
                "deptFilter": {
                    "type": "point", 
                    "fields": ["department"]
                }
            },
            "mark": {"type": "bar", "cornerRadius": 5},
            "encoding": {
                "x": {"field": "department", "type": "nominal", "title": "Részleg"},
                "y": {"aggregate": "count", "title": "Incidensek Száma"},
                "color": {
                    "condition": {"selection": "deptFilter", "value": "#1877f2"},
                    "value": "lightgray"
                },
                "tooltip": [{"field": "department"}, {"aggregate": "count", "title": "Darab"}]
            },
            "title": "Kattints egy oszlopra a szűréshez!"
        };

        const specTrend = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": "container", "height": 250,
            "data": commonData,
            "transform": [
                {"filter": {"selection": "deptFilter"}}
            ],
            "mark": {"type": "line", "point": true},
            "encoding": {
                "x": {"field": "date", "type": "temporal", "timeUnit": "yearmonth", "title": "Hónap"},
                "y": {"aggregate": "count", "title": "Incidensek"},
                "color": {"value": "#ff5722"}
            }
        };

        const specType = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": "container", "height": 250,
            "data": commonData,
            "transform": [
                {"filter": {"selection": "deptFilter"}}
            ],
            "mark": "arc",
            "encoding": {
                "theta": {"aggregate": "count", "field": "type"},
                "color": {"field": "type", "title": "Támadás típusa"},
                "tooltip": [{"field": "type"}, {"aggregate": "count", "title": "Darab"}]
            }
        };

        vegaEmbed('#vis_dept', specDept);
        vegaEmbed('#vis_trend', specTrend);
        vegaEmbed('#vis_type', specType);

    </script>
</body>
</html>
